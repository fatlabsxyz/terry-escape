<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TERRY ESCAPE</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
</head>
<body>
    <div id="join-paywall">
        <div class="join-container">
            <h1 class="join-title">TERRY ESCAPE</h1>
            <p class="join-subtitle">A ZERO-KNOWLEDGE BATTLE ROYALE</p>
            <input type="text" id="username-input" class="username-input" placeholder="ENTER YOUR NAME" maxlength="20">
            <button id="join-btn" class="action-btn">JOIN GAME</button>
        </div>
    </div>
    
    <!-- Turn Timer (Fixed Position) -->
    <div id="turn-timer" class="turn-timer" style="display: none;">
        <div class="timer-label">TIME REMAINING</div>
        <div id="timer-display" class="timer-display">30</div>
        <div class="timer-warning">Act fast or everyone dies!</div>
    </div>
    
    <div class="container">
        <div class="grid-container">
            <h1 class="game-title">TERRY ESCAPE</h1>
            <div id="status-panel" class="status-panel">
                <div class="status-item">
                    <span class="status-label">PLAYERS LEFT</span>
                    <span id="player-count" class="status-value">0</span>
                </div>
                <div class="status-item">
                    <span class="status-label">TURN</span>
                    <span id="turn-number" class="status-value">0</span>
                </div>
                <div class="status-item">
                    <span class="status-label">PHASE</span>
                    <span id="game-phase" class="status-value">WAITING</span>
                </div>
            </div>
            <div class="action-buttons">
                <button id="move-btn" class="action-btn">MOVE</button>
                <button id="trap-btn" class="action-btn">TRAP</button>
                <button id="tutorial-btn" class="action-btn tutorial-btn">TUTORIAL</button>
            </div>
            <div class="game-area">
                <div id="grid" class="grid"></div>
            </div>
            <div id="proof-progress" class="proof-progress" style="display: none;">
                <div class="proof-label">GENERATING PROOF...</div>
                <div class="progress-bar">
                    <div id="progress-fill" class="progress-fill"></div>
                </div>
                <div id="proof-status" class="proof-status">Initializing...</div>
            </div>
            <div id="error-message" class="error-message"></div>
        </div>
        <div class="side-panel">
            <div id="player-board" class="player-board">
                <h3>PLAYERS STATUS</h3>
                <div id="player-list" class="player-list">
                    <!-- Player status cards will be inserted here -->
                </div>
            </div>
            <div class="log-container">
                <h3>GAME LOG</h3>
                <div id="log" class="log"></div>
            </div>
        </div>
    </div>
    
    <!-- Tutorial Modal -->
    <div id="tutorial-modal" class="modal" style="display: none;">
        <div class="modal-content">
            <span class="modal-close">&times;</span>
            <h2>HOW TO PLAY TERRY ESCAPE</h2>
            <div class="tutorial-content">
                <div class="tutorial-section">
                    <h3>üéØ OBJECTIVE</h3>
                    <p>Be the last player standing! Eliminate all opponents by outsmarting them with strategic moves and traps.</p>
                </div>
                
                <div class="tutorial-section">
                    <h3>üéÆ GAME PHASES</h3>
                    <div class="phase-item">
                        <h4>1. DEPLOYMENT PHASE</h4>
                        <p>Place your 4 agents in your designated corner (highlighted cells)</p>
                    </div>
                    <div class="phase-item">
                        <h4>2. BATTLE PHASE</h4>
                        <p>Take turns making moves. When it's your turn, you MUST act within 30 seconds!</p>
                    </div>
                </div>
                
                <div class="tutorial-section">
                    <h3>‚ö° ACTIONS (Choose One Per Turn)</h3>
                    <div class="action-item">
                        <h4>MOVE</h4>
                        <p>‚Ä¢ Click MOVE button ‚Üí Select your agent ‚Üí Click adjacent cell<br>
                           ‚Ä¢ Agents can only move to directly adjacent cells (‚Üë‚Üì‚Üê‚Üí)</p>
                    </div>
                    <div class="action-item">
                        <h4>TRAP</h4>
                        <p>‚Ä¢ Click TRAP button ‚Üí Select your agent ‚Üí Click adjacent cell<br>
                           ‚Ä¢ Traps are invisible to enemies and trigger when stepped on</p>
                    </div>
                </div>
                
                <div class="tutorial-section">
                    <h3>üíÄ HOW AGENTS DIE</h3>
                    <div class="death-rule">
                        <strong>COLLISION:</strong> Two agents enter same cell = BOTH DIE! üí•
                    </div>
                    <div class="death-rule">
                        <strong>TRAP:</strong> Agent steps on trap = Agent dies, trap consumed üí£
                    </div>
                    <div class="death-rule">
                        <strong>TRAP PLACEMENT:</strong> Placing trap on enemy = Enemy dies instantly
                    </div>
                    <div class="death-rule warning">
                        <strong>‚è±Ô∏è TIMEOUT:</strong> Don't act in 30 seconds = ALL YOUR AGENTS DIE!
                    </div>
                </div>
                
                <div class="tutorial-section">
                    <h3>üõ°Ô∏è ZERO-KNOWLEDGE SECURITY</h3>
                    <p>Your moves are hidden from opponents using cryptographic proofs. The "Generating Proof" message means your action is being securely processed without revealing your strategy!</p>
                </div>
                
                <div class="tutorial-section">
                    <h3>üí° PRO TIPS</h3>
                    <div class="tip">‚Ä¢ Control the center for maximum mobility</div>
                    <div class="tip">‚Ä¢ Set trap chains to create safe zones</div>
                    <div class="tip">‚Ä¢ As the active player, YOU survive collisions!</div>
                    <div class="tip">‚Ä¢ Watch for patterns in enemy movement</div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Victory/Defeat Overlay -->
    <div id="game-over-overlay" class="game-over-overlay" style="display: none;">
        <div id="game-over-content" class="game-over-content">
            <!-- Content will be dynamically inserted -->
        </div>
    </div>
    
    <!-- Player Dead Overlay -->
    <div id="player-dead-overlay" class="player-dead-overlay" style="display: none;">
        <div class="player-dead-content">
            <div class="dead-emoji">üíÄ</div>
            <h2 class="dead-title">YOU ARE DEAD</h2>
            <p class="dead-message">
                But don't disconnect! We still need you online for the MPC process, bro.
            </p>
            <p class="dead-submessage">
                Your cooperation keeps the game running for everyone else.
            </p>
            <div class="dead-status">
                <span class="status-dot"></span>
                <span>Connected and helping with MPC</span>
            </div>
        </div>
    </div>
    
    <!-- Background Music -->
    <audio id="bg-music" loop>
        <source src="balatro.mp3" type="audio/mpeg">
    </audio>
    
    <!-- Music Control -->
    <div id="music-control" class="music-control">
        <button id="music-toggle" class="music-toggle" title="Toggle Music">üéµ</button>
    </div>
    
    <script src="out.js" type="module"></script>
</body>
</html>
